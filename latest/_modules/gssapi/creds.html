

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gssapi.creds &mdash; Python-GSSAPI 1.10.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=1d24b1d9"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Python-GSSAPI
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../gssapi.html">High-Level API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gssapi.raw.html">Low-Level API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../otherdoc.html">Other Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Python-GSSAPI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">gssapi.creds</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for gssapi.creds</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">t</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">gssapi.raw</span><span class="w"> </span><span class="kn">import</span> <span class="n">creds</span> <span class="k">as</span> <span class="n">rcreds</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gssapi.raw</span><span class="w"> </span><span class="kn">import</span> <span class="n">named_tuples</span> <span class="k">as</span> <span class="n">tuples</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gssapi.raw</span><span class="w"> </span><span class="kn">import</span> <span class="n">names</span> <span class="k">as</span> <span class="n">rnames</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gssapi.raw</span><span class="w"> </span><span class="kn">import</span> <span class="n">oids</span> <span class="k">as</span> <span class="n">roids</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">gssapi._utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">import_gssapi_extension</span><span class="p">,</span> <span class="n">_encode_dict</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">gssapi</span><span class="w"> </span><span class="kn">import</span> <span class="n">names</span>

<span class="n">rcred_imp_exp</span> <span class="o">=</span> <span class="n">import_gssapi_extension</span><span class="p">(</span><span class="s1">&#39;cred_imp_exp&#39;</span><span class="p">)</span>
<span class="n">rcred_s4u</span> <span class="o">=</span> <span class="n">import_gssapi_extension</span><span class="p">(</span><span class="s1">&#39;s4u&#39;</span><span class="p">)</span>
<span class="n">rcred_cred_store</span> <span class="o">=</span> <span class="n">import_gssapi_extension</span><span class="p">(</span><span class="s1">&#39;cred_store&#39;</span><span class="p">)</span>
<span class="n">rcred_rfc5588</span> <span class="o">=</span> <span class="n">import_gssapi_extension</span><span class="p">(</span><span class="s1">&#39;rfc5588&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="Credentials">
<a class="viewcode-back" href="../../gssapi.html#gssapi.creds.Credentials">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Credentials</span><span class="p">(</span><span class="n">rcreds</span><span class="o">.</span><span class="n">Creds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;GSSAPI Credentials</span>

<span class="sd">    This class represents a set of GSSAPI credentials which may</span>
<span class="sd">    be used with and/or returned by other GSSAPI methods.</span>

<span class="sd">    It inherits from the low-level GSSAPI :class:`~gssapi.raw.creds.Creds`</span>
<span class="sd">    class, and thus may used with both low-level and high-level API methods.</span>

<span class="sd">    If your implementation of GSSAPI supports the credentials import-export</span>
<span class="sd">    extension, you may pickle and unpickle this object.</span>

<span class="sd">    The constructor either acquires or imports a set of GSSAPI</span>
<span class="sd">    credentials.</span>

<span class="sd">    If the `base` argument is used, an existing</span>
<span class="sd">    :class:`~gssapi.raw.creds.Creds` object from the low-level API is</span>
<span class="sd">    converted into a high-level object.</span>

<span class="sd">    If the `token` argument is used, the credentials</span>
<span class="sd">    are imported using the token, if the credentials import-export</span>
<span class="sd">    extension is supported (:requires-ext:`cred_imp_exp`).</span>

<span class="sd">    Otherwise, the credentials are acquired as per the</span>
<span class="sd">    :meth:`acquire` method.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ~gssapi.exceptions.BadMechanismError</span>
<span class="sd">        ~gssapi.exceptions.BadNameTypeError</span>
<span class="sd">        ~gssapi.exceptions.BadNameError</span>
<span class="sd">        ~gssapi.exceptions.ExpiredCredentialsError</span>
<span class="sd">        ~gssapi.exceptions.MissingCredentialsError</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__new__</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">base</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">rcreds</span><span class="o">.</span><span class="n">Creds</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">token</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">bytes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">rnames</span><span class="o">.</span><span class="n">Name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lifetime</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mechs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">roids</span><span class="o">.</span><span class="n">OID</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">usage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">store</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span>
            <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Credentials&quot;</span><span class="p">:</span>
        <span class="c1"># TODO(directxman12): this is missing support for password</span>
        <span class="c1">#                     (non-RFC method)</span>
        <span class="k">if</span> <span class="n">base</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">base_creds</span> <span class="o">=</span> <span class="n">base</span>
        <span class="k">elif</span> <span class="n">token</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rcred_imp_exp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Your GSSAPI implementation does &quot;</span>
                                          <span class="s2">&quot;not have support for importing and &quot;</span>
                                          <span class="s2">&quot;exporting creditials&quot;</span><span class="p">)</span>

            <span class="n">base_creds</span> <span class="o">=</span> <span class="n">rcred_imp_exp</span><span class="o">.</span><span class="n">import_cred</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lifetime</span><span class="p">,</span> <span class="n">mechs</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span>
                              <span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">)</span>
            <span class="n">base_creds</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">creds</span>

        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Credentials&quot;</span><span class="p">,</span>
                      <span class="nb">super</span><span class="p">(</span><span class="n">Credentials</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base_creds</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">names</span><span class="o">.</span><span class="n">Name</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the name associated with these credentials&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">names</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">inquire</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">usage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">mechs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lifetime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the remaining lifetime of these credentials, in seconds&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">inquire</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">usage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mechs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">lifetime</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mechs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">roids</span><span class="o">.</span><span class="n">OID</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the mechanisms for these credentials&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">Set</span><span class="p">[</span><span class="n">roids</span><span class="o">.</span><span class="n">OID</span><span class="p">],</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">inquire</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">usage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mechs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mechs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">usage</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the usage (initiate, accept, or both) of these credentials&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">t</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">inquire</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">lifetime</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">usage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mechs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">usage</span><span class="p">)</span>

<div class="viewcode-block" id="Credentials.acquire">
<a class="viewcode-back" href="../../gssapi.html#gssapi.creds.Credentials.acquire">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">acquire</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">rnames</span><span class="o">.</span><span class="n">Name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lifetime</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mechs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">roids</span><span class="o">.</span><span class="n">OID</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">usage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">store</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span>
            <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tuples</span><span class="o">.</span><span class="n">AcquireCredResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Acquire GSSAPI credentials</span>

<span class="sd">        This method acquires credentials.  If the `store` argument is</span>
<span class="sd">        used, the credentials will be acquired from the given</span>
<span class="sd">        credential store (if supported).  Otherwise, the credentials are</span>
<span class="sd">        acquired from the default store.</span>

<span class="sd">        The credential store information is a dictionary containing</span>
<span class="sd">        mechanisms-specific keys and values pointing to a credential store</span>
<span class="sd">        or stores.</span>

<span class="sd">        Using a non-default store requires support for the credentials store</span>
<span class="sd">        extension.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (~gssapi.names.Name): the name associated with the</span>
<span class="sd">                credentials, or None for the default name</span>
<span class="sd">            lifetime (int): the desired lifetime of the credentials in seconds,</span>
<span class="sd">                or None for indefinite</span>
<span class="sd">            mechs (list): the desired :class:`MechType` OIDs to be used</span>
<span class="sd">                with the credentials, or None for the default set</span>
<span class="sd">            usage (str): the usage for the credentials -- either &#39;both&#39;,</span>
<span class="sd">                &#39;initiate&#39;, or &#39;accept&#39;</span>
<span class="sd">            store (dict): the credential store information pointing to the</span>
<span class="sd">                credential store from which to acquire the credentials,</span>
<span class="sd">                or None for the default store (:requires-ext:`cred_store`)</span>

<span class="sd">        Returns:</span>
<span class="sd">            AcquireCredResult: the acquired credentials and information about</span>
<span class="sd">            them</span>

<span class="sd">        Raises:</span>
<span class="sd">            ~gssapi.exceptions.BadMechanismError</span>
<span class="sd">            ~gssapi.exceptions.BadNameTypeError</span>
<span class="sd">            ~gssapi.exceptions.BadNameError</span>
<span class="sd">            ~gssapi.exceptions.ExpiredCredentialsError</span>
<span class="sd">            ~gssapi.exceptions.MissingCredentialsError</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">store</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">rcreds</span><span class="o">.</span><span class="n">acquire_cred</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lifetime</span><span class="p">,</span>
                                      <span class="n">mechs</span><span class="p">,</span> <span class="n">usage</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rcred_cred_store</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Your GSSAPI implementation does &quot;</span>
                                          <span class="s2">&quot;not have support for manipulating &quot;</span>
                                          <span class="s2">&quot;credential stores&quot;</span><span class="p">)</span>

            <span class="n">b_store</span> <span class="o">=</span> <span class="n">_encode_dict</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">rcred_cred_store</span><span class="o">.</span><span class="n">acquire_cred_from</span><span class="p">(</span><span class="n">b_store</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                                                     <span class="n">lifetime</span><span class="p">,</span> <span class="n">mechs</span><span class="p">,</span>
                                                     <span class="n">usage</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">tuples</span><span class="o">.</span><span class="n">AcquireCredResult</span><span class="p">(</span><span class="bp">cls</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">creds</span><span class="p">),</span> <span class="n">res</span><span class="o">.</span><span class="n">mechs</span><span class="p">,</span>
                                        <span class="n">res</span><span class="o">.</span><span class="n">lifetime</span><span class="p">)</span></div>


<div class="viewcode-block" id="Credentials.store">
<a class="viewcode-back" href="../../gssapi.html#gssapi.creds.Credentials.store">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">store</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">store</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span>
            <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">usage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">mech</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">roids</span><span class="o">.</span><span class="n">OID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_default</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tuples</span><span class="o">.</span><span class="n">StoreCredResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Store these credentials into the given store</span>

<span class="sd">        This method stores the current credentials into the specified</span>
<span class="sd">        credentials store.  If the default store is used, support for</span>
<span class="sd">        :rfc:`5588` is required.  Otherwise, support for the credentials</span>
<span class="sd">        store extension is required.</span>

<span class="sd">        :requires-ext:`rfc5588` or :requires-ext:`cred_store`</span>

<span class="sd">        Args:</span>
<span class="sd">            store (dict): the store into which to store the credentials,</span>
<span class="sd">                or None for the default store.</span>
<span class="sd">            usage (str): the usage to store the credentials with -- either</span>
<span class="sd">                &#39;both&#39;, &#39;initiate&#39;, or &#39;accept&#39;</span>
<span class="sd">            mech (~gssapi.OID): the :class:`MechType` to associate with the</span>
<span class="sd">                stored credentials</span>
<span class="sd">            overwrite (bool): whether or not to overwrite existing credentials</span>
<span class="sd">                stored with the same name, etc</span>
<span class="sd">            set_default (bool): whether or not to set these credentials as</span>
<span class="sd">                the default credentials for the given store.</span>

<span class="sd">        Returns:</span>
<span class="sd">            StoreCredResult: the results of the credential storing operation</span>

<span class="sd">        Raises:</span>
<span class="sd">            ~gssapi.exceptions.GSSError</span>
<span class="sd">            ~gssapi.exceptions.ExpiredCredentialsError</span>
<span class="sd">            ~gssapi.exceptions.MissingCredentialsError</span>
<span class="sd">            ~gssapi.exceptions.OperationUnavailableError</span>
<span class="sd">            ~gssapi.exceptions.DuplicateCredentialsElementError</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">store</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rcred_rfc5588</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Your GSSAPI implementation does &quot;</span>
                                          <span class="s2">&quot;not have support for RFC 5588&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">rcred_rfc5588</span><span class="o">.</span><span class="n">store_cred</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span> <span class="n">mech</span><span class="p">,</span>
                                            <span class="n">overwrite</span><span class="p">,</span> <span class="n">set_default</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rcred_cred_store</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Your GSSAPI implementation does &quot;</span>
                                          <span class="s2">&quot;not have support for manipulating &quot;</span>
                                          <span class="s2">&quot;credential stores directly&quot;</span><span class="p">)</span>

            <span class="n">b_store</span> <span class="o">=</span> <span class="n">_encode_dict</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">rcred_cred_store</span><span class="o">.</span><span class="n">store_cred_into</span><span class="p">(</span><span class="n">b_store</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span> <span class="n">mech</span><span class="p">,</span>
                                                    <span class="n">overwrite</span><span class="p">,</span> <span class="n">set_default</span><span class="p">)</span></div>


<div class="viewcode-block" id="Credentials.impersonate">
<a class="viewcode-back" href="../../gssapi.html#gssapi.creds.Credentials.impersonate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">impersonate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">rnames</span><span class="o">.</span><span class="n">Name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">lifetime</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mechs</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Iterable</span><span class="p">[</span><span class="n">roids</span><span class="o">.</span><span class="n">OID</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">usage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;initiate&#39;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Credentials&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Impersonate a name using the current credentials</span>

<span class="sd">        This method acquires credentials by impersonating another</span>
<span class="sd">        name using the current credentials.</span>

<span class="sd">        :requires-ext:`s4u`</span>

<span class="sd">        Args:</span>
<span class="sd">            name (~gssapi.names.Name): the name to impersonate</span>
<span class="sd">            lifetime (int): the desired lifetime of the new credentials in</span>
<span class="sd">                seconds, or None for indefinite</span>
<span class="sd">            mechs (list): the desired :class:`MechType` OIDs for the new</span>
<span class="sd">                credentials</span>
<span class="sd">            usage (str): the desired usage for the new credentials -- either</span>
<span class="sd">                &#39;both&#39;, &#39;initiate&#39;, or &#39;accept&#39;.  Note that some mechanisms</span>
<span class="sd">                may only support &#39;initiate&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Credentials: the new credentials impersonating the given name</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">rcred_s4u</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Your GSSAPI implementation does not &quot;</span>
                                      <span class="s2">&quot;have support for S4U&quot;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">rcred_s4u</span><span class="o">.</span><span class="n">acquire_cred_impersonate_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
                                                      <span class="n">lifetime</span><span class="p">,</span> <span class="n">mechs</span><span class="p">,</span>
                                                      <span class="n">usage</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">base</span><span class="o">=</span><span class="n">res</span><span class="o">.</span><span class="n">creds</span><span class="p">)</span></div>


<div class="viewcode-block" id="Credentials.inquire">
<a class="viewcode-back" href="../../gssapi.html#gssapi.creds.Credentials.inquire">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">inquire</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">lifetime</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">usage</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">mechs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tuples</span><span class="o">.</span><span class="n">InquireCredResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inspect these credentials for information</span>

<span class="sd">        This method inspects these credentials for information about them.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (bool): get the name associated with the credentials</span>
<span class="sd">            lifetime (bool): get the remaining lifetime for the credentials</span>
<span class="sd">            usage (bool): get the usage for the credentials</span>
<span class="sd">            mechs (bool): get the mechanisms associated with the credentials</span>

<span class="sd">        Returns:</span>
<span class="sd">            InquireCredResult: the information about the credentials,</span>
<span class="sd">            with None used when the corresponding argument was False</span>

<span class="sd">        Raises:</span>
<span class="sd">            ~gssapi.exceptions.MissingCredentialsError</span>
<span class="sd">            ~gssapi.exceptions.InvalidCredentialsError</span>
<span class="sd">            ~gssapi.exceptions.ExpiredCredentialsError</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">rcreds</span><span class="o">.</span><span class="n">inquire_cred</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lifetime</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span> <span class="n">mechs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">res_name</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">Name</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res_name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">tuples</span><span class="o">.</span><span class="n">InquireCredResult</span><span class="p">(</span><span class="n">res_name</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">lifetime</span><span class="p">,</span>
                                        <span class="n">res</span><span class="o">.</span><span class="n">usage</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">mechs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Credentials.inquire_by_mech">
<a class="viewcode-back" href="../../gssapi.html#gssapi.creds.Credentials.inquire_by_mech">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">inquire_by_mech</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">mech</span><span class="p">:</span> <span class="n">roids</span><span class="o">.</span><span class="n">OID</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">init_lifetime</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">accept_lifetime</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">usage</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tuples</span><span class="o">.</span><span class="n">InquireCredByMechResult</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Inspect these credentials for per-mechanism information</span>

<span class="sd">        This method inspects these credentials for per-mechanism information</span>
<span class="sd">        about them.</span>

<span class="sd">        Args:</span>
<span class="sd">            mech (~gssapi.OID): the mechanism for which to retrieve the</span>
<span class="sd">                information</span>
<span class="sd">            name (bool): get the name associated with the credentials</span>
<span class="sd">            init_lifetime (bool): get the remaining initiate lifetime for</span>
<span class="sd">                the credentials in seconds</span>
<span class="sd">            accept_lifetime (bool): get the remaining accept lifetime for</span>
<span class="sd">                the credentials in seconds</span>
<span class="sd">            usage (bool): get the usage for the credentials</span>

<span class="sd">        Returns:</span>
<span class="sd">            InquireCredByMechResult: the information about the credentials,</span>
<span class="sd">            with None used when the corresponding argument was False</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">rcreds</span><span class="o">.</span><span class="n">inquire_cred_by_mech</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mech</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">init_lifetime</span><span class="p">,</span>
                                          <span class="n">accept_lifetime</span><span class="p">,</span> <span class="n">usage</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">res_name</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">Name</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res_name</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">tuples</span><span class="o">.</span><span class="n">InquireCredByMechResult</span><span class="p">(</span><span class="n">res_name</span><span class="p">,</span>
                                              <span class="n">res</span><span class="o">.</span><span class="n">init_lifetime</span><span class="p">,</span>
                                              <span class="n">res</span><span class="o">.</span><span class="n">accept_lifetime</span><span class="p">,</span>
                                              <span class="n">res</span><span class="o">.</span><span class="n">usage</span><span class="p">)</span></div>


<div class="viewcode-block" id="Credentials.add">
<a class="viewcode-back" href="../../gssapi.html#gssapi.creds.Credentials.add">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">rnames</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span>
        <span class="n">mech</span><span class="p">:</span> <span class="n">roids</span><span class="o">.</span><span class="n">OID</span><span class="p">,</span>
        <span class="n">usage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">,</span>
        <span class="n">init_lifetime</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">accept_lifetime</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">impersonator</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">rcreds</span><span class="o">.</span><span class="n">Creds</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">store</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span>
            <span class="n">t</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Credentials&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Acquire more credentials to add to the current set</span>

<span class="sd">        This method works like :meth:`acquire`, except that it adds the</span>
<span class="sd">        acquired credentials for a single mechanism to a copy of the current</span>
<span class="sd">        set, instead of creating a new set for multiple mechanisms.</span>
<span class="sd">        Unlike :meth:`acquire`, you cannot pass None desired name or</span>
<span class="sd">        mechanism.</span>

<span class="sd">        If the `impersonator` argument is used, the credentials will</span>
<span class="sd">        impersonate the given name using the impersonator credentials</span>
<span class="sd">        (:requires-ext:`s4u`).</span>

<span class="sd">        If the `store` argument is used, the credentials will be acquired</span>
<span class="sd">        from the given credential store (:requires-ext:`cred_store`).</span>
<span class="sd">        Otherwise, the credentials are acquired from the default store.</span>

<span class="sd">        The credential store information is a dictionary containing</span>
<span class="sd">        mechanisms-specific keys and values pointing to a credential store</span>
<span class="sd">        or stores.</span>

<span class="sd">        Note that the `store` argument is not compatible with the</span>
<span class="sd">        `impersonator` argument.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (~gssapi.names.Name): the name associated with the</span>
<span class="sd">                credentials</span>
<span class="sd">            mech (~gssapi.OID): the desired :class:`MechType` to be used with</span>
<span class="sd">                the credentials</span>
<span class="sd">            usage (str): the usage for the credentials -- either &#39;both&#39;,</span>
<span class="sd">                &#39;initiate&#39;, or &#39;accept&#39;</span>
<span class="sd">            init_lifetime (int): the desired initiate lifetime of the</span>
<span class="sd">                credentials in seconds, or None for indefinite</span>
<span class="sd">            accept_lifetime (int): the desired accept lifetime of the</span>
<span class="sd">                credentials in seconds, or None for indefinite</span>
<span class="sd">            impersonator (Credentials): the credentials to use to impersonate</span>
<span class="sd">                the given name, or None to not acquire normally</span>
<span class="sd">                (:requires-ext:`s4u`)</span>
<span class="sd">            store (dict): the credential store information pointing to the</span>
<span class="sd">                credential store from which to acquire the credentials,</span>
<span class="sd">                or None for the default store (:requires-ext:`cred_store`)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Credentials: the credentials set containing the current credentials</span>
<span class="sd">            and the newly acquired ones.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ~gssapi.exceptions.BadMechanismError</span>
<span class="sd">            ~gssapi.exceptions.BadNameTypeError</span>
<span class="sd">            ~gssapi.exceptions.BadNameError</span>
<span class="sd">            ~gssapi.exceptions.DuplicateCredentialsElementError</span>
<span class="sd">            ~gssapi.exceptions.ExpiredCredentialsError</span>
<span class="sd">            ~gssapi.exceptions.MissingCredentialsError</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">impersonator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;You cannot use both the `impersonator` and &#39;</span>
                             <span class="s1">&#39;`store` arguments at the same time&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">store</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rcred_cred_store</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Your GSSAPI implementation does &quot;</span>
                                          <span class="s2">&quot;not have support for manipulating &quot;</span>
                                          <span class="s2">&quot;credential stores&quot;</span><span class="p">)</span>
            <span class="n">b_store</span> <span class="o">=</span> <span class="n">_encode_dict</span><span class="p">(</span><span class="n">store</span><span class="p">)</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">rcred_cred_store</span><span class="o">.</span><span class="n">add_cred_from</span><span class="p">(</span><span class="n">b_store</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mech</span><span class="p">,</span>
                                                 <span class="n">usage</span><span class="p">,</span> <span class="n">init_lifetime</span><span class="p">,</span>
                                                 <span class="n">accept_lifetime</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">impersonator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rcred_s4u</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Your GSSAPI implementation does &quot;</span>
                                          <span class="s2">&quot;not have support for S4U&quot;</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">rcred_s4u</span><span class="o">.</span><span class="n">add_cred_impersonate_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">impersonator</span><span class="p">,</span>
                                                      <span class="n">name</span><span class="p">,</span> <span class="n">mech</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span>
                                                      <span class="n">init_lifetime</span><span class="p">,</span>
                                                      <span class="n">accept_lifetime</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">rcreds</span><span class="o">.</span><span class="n">add_cred</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mech</span><span class="p">,</span> <span class="n">usage</span><span class="p">,</span> <span class="n">init_lifetime</span><span class="p">,</span>
                                  <span class="n">accept_lifetime</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">Credentials</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">creds</span><span class="p">)</span></div>


<div class="viewcode-block" id="Credentials.export">
<a class="viewcode-back" href="../../gssapi.html#gssapi.creds.Credentials.export">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">export</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Export these credentials into a token</span>

<span class="sd">        This method exports the current credentials to a token that can</span>
<span class="sd">        then be imported by passing the `token` argument to the constructor.</span>

<span class="sd">        This is often used to pass credentials between processes.</span>

<span class="sd">        :requires-ext:`cred_imp_exp`</span>

<span class="sd">        Returns:</span>
<span class="sd">            bytes: the exported credentials in token form</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">rcred_imp_exp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Your GSSAPI implementation does not &quot;</span>
                                      <span class="s2">&quot;have support for importing and &quot;</span>
                                      <span class="s2">&quot;exporting creditials&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">rcred_imp_exp</span><span class="o">.</span><span class="n">export_cred</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


    <span class="c1"># pickle protocol support</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">__reduce__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">Type</span><span class="p">[</span><span class="s2">&quot;Credentials&quot;</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]:</span>
        <span class="c1"># the unpickle arguments to new are (base=None, token=self.export())</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">export</span><span class="p">()))</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014, The Python-GSSAPI team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>